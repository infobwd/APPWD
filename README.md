# WD School Portal ‚Äî MVP (Supabase + GitHub Pages)

‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£/‡∏Ç‡πà‡∏≤‡∏ß, ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤, ‡∏•‡∏≤ ‡πÅ‡∏•‡∏∞‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏£‡∏∞‡∏ö‡∏ö ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ **Supabase** (Auth + DB + Storage) ‡πÅ‡∏•‡∏∞‡πÇ‡∏Æ‡∏™‡∏ï‡πå‡πÅ‡∏ö‡∏ö static (GitHub Pages)

## ‡πÇ‡∏Ñ‡∏£‡∏á‡πÑ‡∏ü‡∏•‡πå
```
/index.html
/config.js            # ‡πÉ‡∏™‡πà SUPABASE_URL ‡πÅ‡∏•‡∏∞ ANON KEY
/api.js               # Supabase client + auth helpers
/app.js               # Router + ‡∏´‡∏ô‡πâ‡∏≤ Home + Auth UI
/modules/
  announcements.js    # ‡∏Ç‡πà‡∏≤‡∏ß‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á posts
  checkin.js          # ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤ + ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÑ‡∏õ bucket checkin-photos
  leave.js            # ‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏≤ + ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô
  apphub.js           # ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á app_links
/supabase.sql         # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢ RLS
```

## ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏¢‡πà‡∏≠
1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÉ‡∏ô Supabase
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **SQL Editor** ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏±‡∏ô‡πÑ‡∏ü‡∏•‡πå `supabase.sql`
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Storage** > ‡∏™‡∏£‡πâ‡∏≤‡∏á bucket:
   - `attachments` (‡∏≠‡πà‡∏≤‡∏ô‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞‡πÑ‡∏î‡πâ ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö‡∏Ç‡πà‡∏≤‡∏ß)
   - `checkin-photos` (‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß ‡πÉ‡∏ä‡πâ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÉ‡∏ô `supabase.sql`)
   ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô **Policies** ‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô `supabase.sql`
4. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Authentication > URL Configuration** ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏î‡πÄ‡∏°‡∏ô GitHub Pages ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏ß‡πâ‡πÉ‡∏ô *Redirect URLs*
5. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `config.js` ‡∏à‡∏≤‡∏Å `config.js` (‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤):
   ```js
   export const SUPABASE_URL = "https://YOUR-PROJECT.supabase.co";
   export const SUPABASE_ANON_KEY = "YOUR-ANON-KEY";
   ```
6. ‡πÄ‡∏õ‡∏¥‡∏î `index.html` ‡πÅ‡∏ö‡∏ö local ‡πÑ‡∏î‡πâ ‡∏´‡∏£‡∏∑‡∏≠ push ‡πÑ‡∏õ GitHub ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏¥‡∏î GitHub Pages

## ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á `posts`:
  ```sql
  insert into posts (title, body, category, audience, pinned, published_at)
  values
  ('‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ó‡∏î‡∏™‡∏≠‡∏ö', '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏û‡∏≠‡∏£‡πå‡∏ó‡∏±‡∏•‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', '‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå', 'public', true, now());
  ```
- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á `app_links`:
  ```sql
  insert into app_links (title, url, icon, category, visible_roles)
  values
  ('‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô', 'https://example.com/lunch', 'üç±', '‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ', '{staff}'),
  ('‡∏ô‡∏¥‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô', 'https://example.com/supervision', 'üßë‚Äçüè´', '‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£', '{staff}');
  ```

## Notes
- ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ **Magic link (OTP)** ‚Äî ‡πÉ‡∏™‡πà‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢
- ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏û‡∏™‡∏ï‡πå/‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏•‡∏≤/‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô: ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î role ‡πÉ‡∏ô `public.profiles.role` ‡πÄ‡∏õ‡πá‡∏ô `editor`, `approver` ‡∏´‡∏£‡∏∑‡∏≠ `admin` (update ‡∏ï‡∏£‡∏á‡πÜ ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á)
- ‡∏†‡∏≤‡∏û Check-in ‡πÉ‡∏ä‡πâ **signed URL** ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢ storage ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÉ‡∏´‡πâ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ)

> ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î: ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô, ‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (OIT), Helpdesk/‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô, RBAC ‡∏•‡∏∂‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô, Geofence server logic


## ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÉ‡∏ô Phase 1
- ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πà‡∏≤‡∏ß‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏° (#post?id=ID) + ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô (post_reads)
- ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πà‡∏≤‡∏ß (#compose) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö `editor/admin` + ‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå (post_attachments)
- ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ß‡∏±‡∏ô‡∏•‡∏≤ (leave_balances) ‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Leave
- Router ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÉ‡∏ô hash

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á seed (balances)
```sql
insert into leave_balances (user_id, type, balance)
values
  ('<USER_UUID>', 'vacation', 10),
  ('<USER_UUID>', 'business', 5);
```
