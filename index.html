<!DOCTYPE html><html lang='th' data-theme='light'><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no, maximum-scale=1.0'><title>APPWD v5.5.5</title><link rel='manifest' href='./manifest.json'><link rel='icon' href='./icons/icon-192.png'><meta name='theme-color' content='#EAF2FF'><script>if(/\/APPWD$/.test(location.href))location.replace(location.href+'/');</script><script src='https://cdn.tailwindcss.com'></script><script>tailwind.config={theme:{extend:{fontFamily:{sans:['Kanit','system-ui','sans-serif']},colors:{brand:'#2563EB',brandSoft:'#EAF2FF'},boxShadow:{card:'0 10px 24px rgba(37,99,235,.12)'}}}};</script><link rel='preconnect' href='https://fonts.googleapis.com' crossorigin><link rel='preconnect' href='https://fonts.gstatic.com' crossorigin><link rel='stylesheet' href='https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap'><link rel='stylesheet' href='https://unpkg.com/leaflet@1.9.4/dist/leaflet.css'><script src='https://unpkg.com/leaflet@1.9.4/dist/leaflet.js'></script><style>:root{--safe-b:env(safe-area-inset-bottom);--safe-t:env(safe-area-inset-top);--fs:1;--icon:1;--bg:#F7FAFF;--card:#fff;--bd:#E6EAF0;--ink:#0F172A;--ink2:#475569;--ink3:#64748B}html[data-theme='dark']{--bg:#0B1220;--card:#0F172A;--bd:#233048;--ink:#E7ECF5;--ink2:#C3CCE0;--ink3:#9FB1D9}html,body{height:100%;background:var(--bg);color:var(--ink)}body{font-size:calc(16px*var(--fs))}.card{background:var(--card);border:1px solid var(--bd);border-radius:18px}.btn{display:inline-flex;align-items:center;gap:.5rem;padding:.6rem 1rem;border-radius:12px;border:1px solid var(--bd);background:var(--card);color:var(--ink)}.btn-prim{background:#2563EB;color:#fff;border-color:#2563EB;box-shadow:0 10px 18px rgba(37,99,235,.25)}.hide{display:none!important}.appbar{position:sticky;top:0;z-index:30;background:linear-gradient(180deg,#EAF2FF 0%,var(--card) 100%);border-bottom:1px solid var(--bd);padding-top:calc(10px + var(--safe-t))}.tabbar{position:fixed;left:0;right:0;bottom:0;background:var(--card);border-top:1px solid var(--bd);padding-bottom:calc(8px + var(--safe-b));height:calc(66px + var(--safe-b));z-index:40}.iconbtn{display:flex;flex-direction:column;align-items:center;gap:3px;padding:.5rem 0;min-width:64px}.iconbtn svg{width:calc(24px * var(--icon));height:calc(24px * var(--icon));stroke:#6B7280}.iconbtn.active svg{stroke:#111827}.iconbtn span{display:none}.fab{position:fixed;left:50%;transform:translateX(-50%);bottom:calc(33px + var(--safe-b));z-index:45;width:calc(68px * var(--icon));height:calc(68px * var(--icon));border-radius:20px;background:#2563EB;color:#fff;display:flex;align-items:center;justify-content:center;box-shadow:0 18px 36px rgba(37,99,235,.35)}@media (min-width:1024px){.container{max-width:980px;margin:0 auto}}.cover{width:100%;aspect-ratio:16/9;object-fit:cover;border-radius:14px;border:1px solid var(--bd)}.skeleton{position:relative;overflow:hidden;background:#EEF2F7;border-radius:12px}.skeleton::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.6),transparent);animation:sh 1.2s infinite}@keyframes sh{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}.view{transition:transform .25s ease,opacity .2s ease}.view.hide{display:none}.slide-in{transform:translateX(12px);opacity:0}.slide-in.show{transform:translateX(0);opacity:1}#homeNewsCards.slider{display:grid;grid-auto-flow:column;grid-auto-columns:100%;overflow:auto;scroll-snap-type:x mandatory;gap:0;border-radius:14px}#homeNewsCards.slider>*{scroll-snap-align:center}.news-card{border:1px solid var(--bd);border-radius:14px;overflow:hidden;background:var(--card);position:relative;margin-right:12px}.news-card .thumb{width:100%;aspect-ratio:16/9;object-fit:cover}.badge{position:absolute;right:8px;top:8px;background:#2563EB;color:#fff;border-radius:999px;padding:.15rem .5rem;font-size:11px}@media (max-width:640px){#userBadge span{display:none}}
#sheet{position:fixed;inset:0;background:rgba(2,6,23,.35);backdrop-filter:saturate(140%) blur(6px);display:none;z-index:60}
#sheet.show{display:block}
#sheet .panel{position:absolute;left:0;right:0;bottom:0;background:var(--card);border:1px solid var(--bd);border-bottom:0;border-radius:20px 20px 0 0;box-shadow:0 -18px 40px rgba(0,0,0,.18);max-height:calc(100svh - var(--safe-t) - 80px);overflow:auto;overscroll-behavior:contain}
.sheet-header{position:sticky;top:0;background:var(--card);border-bottom:1px solid var(--bd);padding:12px 14px;border-radius:20px 20px 0 0;z-index:1}
.sheet-body{padding:12px 14px}
.sheet-actions{position:sticky;bottom:0;background:var(--card);border-top:1px solid var(--bd);padding:12px 14px;padding-bottom:calc(12px + var(--safe-b));z-index:1}
.form-grid{display:grid;gap:.6rem}.form-grid label{font-size:12px;color:var(--ink3)}.form-grid input,.form-grid textarea,.form-grid select{width:100%;border:1px solid var(--bd);background:var(--card);color:var(--ink);border-radius:12px;padding:.55rem .7rem}

</style></head><body class='font-sans'><header class='appbar'><div class='container px-4 py-3 flex items-center gap-3'><div id='brandBox' class='w-10 h-10 rounded-xl bg-brand grid place-items-center text-white font-bold'>WD</div><div><div class='text-base font-semibold leading-tight' id='brandTitle'>APPWD</div><div class='text-[11px] text-ink3'>v5.5.5 • Mobile • Powerful</div></div><div class='ml-auto flex items-center gap-2'><button id='btnInstall' class='btn hide'>ติดตั้งแอป</button><div id='userBadge' class='flex items-center gap-2 hide'><img id='userAvatar' class='w-8 h-8 rounded-full border' src=''><span id='userName' class='text-sm'></span></div><button id='btnLineLogin' class='btn btn-prim'>เข้าสู่ระบบด้วย LINE</button><button id='btnLogout' class='btn hide'>ออกจากระบบ</button></div></div></header><main class='container px-4 pb-28 pt-3'><section id='homeView' class='view slide-in show space-y-4'><div class='card p-4'><div class='flex items-center justify-between mb-2'><div class='text-lg font-semibold'>ข่าวล่าสุด</div><a class='text-brand text-sm cursor-pointer' data-nav='#news'>ดูทั้งหมด</a></div><div id='homeNewsList' class='grid gap-2'></div><div class='mt-3'><div class='text-sm font-semibold mb-1'>การ์ดเด่น</div><div id='homeNewsCards' class='grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3'></div></div></div><div class='card p-4'><div class='text-lg font-semibold mb-2'>สรุปการมาปฏิบัติงาน</div><div id='homeSummary' class='grid grid-cols-2 md:grid-cols-4 gap-2'></div></div><div class='card p-4'><div class='flex items-center justify-between mb-2'><div class='text-lg font-semibold'>เช็คอินล่าสุด</div><div class='flex gap-2 text-sm' role='tablist' aria-label='ประเภทเช็คอิน'><button class='btn' data-ci-tab='work'>ลงชื่อปฏิบัติงาน</button><button class='btn' data-ci-tab='meeting'>ประชุม</button><button class='btn' data-ci-tab='training'>อบรม</button><button class='btn' data-ci-tab='official'>ไปราชการ</button></div></div><div id='homeCheckins' class='grid gap-2'></div></div><div class='card p-4'><div class='text-lg font-semibold mb-2'>แอป/ระบบในโรงเรียน</div><div id='homeLinks' class='grid grid-cols-4 gap-3 text-center'></div></div></section><section id='newsView' class='view hide space-y-3'><div class='card p-4'><div class='flex items-center justify-between mb-2'><div class='text-lg font-semibold'>ข่าว/ประกาศ</div><div class='flex items-center gap-2'><button id='btnComposePost' class='btn btn-prim hide'>+ เพิ่มข่าว</button></div></div><div id='newsList' class='grid gap-2'></div><div class='flex items-center justify-between mt-3'><button id='btnPrev' class='btn'>ก่อนหน้า</button><div id='pageInfo' class='text-sm text-ink3'></div><button id='btnNext' class='btn'>ถัดไป</button></div></div></section><section id='postView' class='view hide'><div class='card p-4'><button id='btnBackList' class='btn mb-3'>← กลับรายการข่าว</button><article id='postDetail'></article></div></section><section id='linksView' class='view hide'><div class='card p-4'><div class='flex items-center justify-between mb-2'><div class='text-lg font-semibold'>ศูนย์ลิงก์ระบบ</div><button id='btnComposeLink' class='btn btn-prim hide'>+ เพิ่มลิงก์</button></div><div id='linkGrid' class='grid gap-4'></div></div></section><section id='profileView' class='view hide'><div class='card p-4 space-y-3'><div class='flex items-center gap-3'><img id='pfAvatar' class='w-12 h-12 rounded-full border' src=''><div><div id='pfName' class='font-semibold'>ยังไม่เข้าสู่ระบบ</div><div id='pfSub' class='text-sm text-ink3'>กด “เข้าสู่ระบบด้วย LINE” มุมขวาบน</div></div></div><div class='grid grid-cols-2 gap-2'><button id='btnTheme' class='btn'>ขนาดตัวอักษร/ธีม</button><button id='btnLogout2' class='btn'>ออกจากระบบ</button></div></div><div id='adminCard' class='card p-4 space-y-3 hide'><div class='text-base font-semibold'>การตั้งค่าระบบ (ผู้ดูแล)</div><div class='grid md:grid-cols-2 gap-2 text-sm'><label>CHECKIN_START <input id='set_CHECKIN_START' class='border rounded p-2 w-full'></label><label>CHECKIN_ON_TIME_UNTIL <input id='set_CHECKIN_ON_TIME_UNTIL' class='border rounded p-2 w-full'></label><label>SUMMARY_DEFAULT_RANGE_DAYS <input id='set_SUMMARY_DEFAULT_RANGE_DAYS' type='number' class='border rounded p-2 w-full'></label><label>SLIDER_AUTO_MS <input id='set_SLIDER_AUTO_MS' type='number' class='border rounded p-2 w-full'></label><label>BRAND_TITLE <input id='set_BRAND_TITLE' class='border rounded p-2 w-full'></label><label>BRAND_LOGO_URL <input id='set_BRAND_LOGO_URL' class='border rounded p-2 w-full'></label></div><div class='flex gap-2'><button id='btnSaveSettings' class='btn btn-prim'>บันทึก</button><button id='btnReloadSettings' class='btn'>รีโหลด</button></div><div class='text-[12px] text-ink3'>* การตั้งค่าจะถูกเก็บในฐานข้อมูลและโหลดอัตโนมัติเมื่อเข้าแอป</div></div></section><section id='checkinView' class='view hide'><div class='card p-4 space-y-3'><div class='text-sm text-ink2'>เช็คอินด้วย 2 วิธี: <b>ตำแหน่ง (GPS)</b> หรือ <b>สแกน QR</b> (ใช้กล้อง)</div><div class='grid grid-cols-2 gap-2'><button id='btnGpsOnly' class='btn btn-prim'>เช็คอินด้วยตำแหน่ง</button><button id='btnOpenScanner' class='btn'>เปิดกล้องสแกน QR</button></div></div><div id='scanPanel' class='card p-0 overflow-hidden hide'><div class='flex items-center justify-between px-3 py-2 border-b' style='border-color:var(--bd)'><div class='text-sm font-semibold'>สแกน QR</div><button id='btnCloseScanner' class='btn'>ปิดกล้อง</button></div><div id='qrReader' class='w-full'></div></div><div class='card p-0 overflow-hidden'><div id='map' style='height:220px'></div><div class='p-3 space-y-2'><div id='geoState' class='text-sm text-ink2'></div><div id='scanResult' class='text-sm text-ink2 break-all'></div><div class='grid grid-cols-2 gap-2'><button id='btnCheckin' class='btn btn-prim'>เช็คอิน (QR+GPS)</button><button id='btnRefreshGeo' class='btn'>อ่านตำแหน่งอีกครั้ง</button></div></div></div><div class='card p-4 mt-3'><div class='text-base font-semibold mb-1'>ประวัติวันนี้</div><div id='todayList' class='grid gap-2'></div></div><div class='card p-4 mt-3'><div class='text-base font-semibold mb-2'>สรุปผล — สัปดาห์ / เดือน / ปี</div><div id='checkinSummary' class='grid grid-cols-1 md:grid-cols-3 gap-2'></div></div></section></main><nav class='tabbar'><div class='container grid grid-cols-4'><button class='iconbtn navbtn active' data-nav='#home' aria-label='หน้าแรก'><svg viewBox='0 0 24 24' fill='none' stroke-width='2'><path d='M3 12l9-9 9 9'/><path d='M9 21V9h6v12'/></svg><span>หน้าแรก</span></button><button class='iconbtn navbtn' data-nav='#news' aria-label='ข่าว'><svg viewBox='0 0 24 24' fill='none' stroke-width='2'><path d='M3 4h18'/><path d='M3 10h18'/><path d='M3 16h18'/></svg><span>ข่าว</span></button><button class='iconbtn navbtn' data-nav='#links' aria-label='ลิงก์'><svg viewBox='0 0 24 24' fill='none' stroke-width='2'><rect x='3' y='3' width='7' height='7' rx='2'/><rect x='14' y='3' width='7' height='7' rx='2'/><rect x='3' y='14' width='7' height='7' rx='2'/><rect x='14' y='14' width='7' height='7' rx='2'/></svg><span>ลิงก์</span></button><button class='iconbtn navbtn' data-nav='#profile' aria-label='โปรไฟล์'><svg viewBox='0 0 24 24' fill='none' stroke-width='2'><circle cx='12' cy='8' r='4'/><path d='M6 20c0-3.3 2.7-6 6-6s6 2.7 6 6'/></svg><span>โปรไฟล์</span></button></div></nav><button id='fabScan' class='fab' title='สแกน/เช็คอิน' aria-label='สแกน/เช็คอิน'><svg viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' width='28' height='28'><path d='M4 7V4h3'/><path d='M20 7V4h-3'/><path d='M4 17v3h3'/><path d='M20 17v3h-3'/><rect x='8' y='8' width='8' height='8' rx='2'/></svg></button><div id='sheet'><div class='panel'><div class='sheet-header'><div class='mx-auto h-1.5 w-10 rounded-full bg-gray-300 mb-2'></div><div class='flex items-center justify-between'><div id='sheet-title' class='font-semibold'></div><button id='sheet-close' class='btn'>ปิด</button></div></div><div id='sheet-body' class='sheet-body'></div><div id='sheet-actions' class='sheet-actions'></div></div></div><div id='sheet-body'></div></div></div><div id='toast' class='hide'></div><script src='https://static.line-scdn.net/liff/edge/2/sdk.js'></script><script src='https://cdn.jsdelivr.net/npm/marked/marked.min.js'></script><script src='https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js'></script><script src='https://cdn.jsdelivr.net/npm/html5-qrcode@2.3.8/html5-qrcode.min.js'></script><script type='module' src='./ui.js?v=555'></script><script type='module' src='./settings.js?v=555'></script><script type='module' src='./liff.js?v=555'></script><script type='module' src='./app.js?v=555'></script><script>if('serviceWorker' in navigator){addEventListener('load',()=>navigator.serviceWorker.register('./sw.js?v=555'));}</script></body></html>